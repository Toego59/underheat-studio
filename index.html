<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>UNDERHEAT Studio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simplelightbox@2.14.2/dist/simple-lightbox.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
    <link rel="stylesheet" href="style.css">
    <meta name="description" content="Educational content management system for creative digital arts">
</head>
<body>

    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-container">
                    <img id="logo-img" class="logo-image" src="images/logo.png" alt="UNDERHEAT Studio Logo" onerror="handleLogoError()">
                    <div class="logo">UNDERHEAT Studio</div>
                </div>
                <nav>
                    <ul>
                        <li><a href="#home" class="active">Home</a></li>
                        <li><a href="#projects">Our Games</a></li>
                        <li><a href="#" id="audio-tab">Audio</a></li>
                        <li><a href="#qa">Knowledge Base</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="container">
            <h1>Welcome to UNDERHEAT Studio</h1>
            <p>Where creative passion meets digital innovation. We specialize in crafting immersive gaming experiences and interactive digital content.</p>
            <a class="btn" href="#projects">Explore Our Games</a>
            
            <!-- Share Buttons -->
            <div class="share-buttons">
                <a href="#" class="share-btn" data-share="twitter">
                    <i class="fab fa-twitter"></i> Twitter
                </a>
                <a href="#" class="share-btn" data-share="facebook">
                    <i class="fab fa-facebook"></i> Facebook
                </a>
                <a href="#" class="share-btn" data-share="linkedin">
                    <i class="fab fa-linkedin"></i> LinkedIn
                </a>
                <a href="#" class="share-btn" data-share="reddit">
                    <i class="fab fa-reddit"></i> Reddit
                </a>
            </div>
        </div>
    </section>

    <section id="projects">
        <div class="container">
            <h2 class="section-title">Our Game Projects</h2>
            <div class="projects">
                <div class="project-card">
                    <div class="project-img" data-src="https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80">AT</div>
                    <div class="project-info">
                        <h3>Ashes Till Tomorrow</h3>
                        <p>Ashes Till Tomorrow is a realistic survival game based of retro futurism of the 20th century being bombed and rebuilt from the ashes.</p>
                    </div>
                </div>

                <div class="project-card">
                    <div class="project-img" data-src="https://images.unsplash.com/photo-1534423861386-85a16f5d13fd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80">CL</div>
                    <div class="project-info">
                        <h3>Critter Land</h3>
                        <p>Critter Land is a immersive Indie Mascot Horror Game, With it being a free roam exploration of you finding the forgotten park of Critter Land.</p>
                    </div>
                </div>
            </div>
            
            <!-- Gallery for project images -->
            <div class="gallery" style="display: none;">
                <a href="https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" data-caption="Ashes Till Tomorrow - Survival Game"></a>
                <a href="https://images.unsplash.com/photo-1534423861386-85a16f5d13fd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" data-caption="Critter Land - Horror Adventure"></a>
            </div>
        </div>
    </section>

    <!-- Q&A Knowledge Base Section -->
    <section id="qa" class="qa-section">
        <div class="container">
            <h2 class="section-title">Knowledge Base</h2>
            <p class="section-subtitle">Search our knowledge base for answers to common questions</p>
            
            <div class="qa-container">
                <div class="qa-card">
                    <h3>Add New Q&A</h3>
                    <div class="qa-form">
                        <input type="text" id="id" placeholder="ID/Category (e.g., general, javascript)">
                        <input type="text" id="question" placeholder="Question">
                        <input type="text" id="answer" placeholder="Answer">
                        <button onclick="addQnA()">Add Q&A</button>
                    </div>
                    <div id="addResult" class="result"></div>
                </div>
                
                <div class="qa-card">
                    <h3>Search Q&A</h3>
                    <div class="qa-form">
                        <input type="text" id="searchId" placeholder="ID/Category to search">
                        <input type="text" id="searchQuestion" placeholder="Question to search">
                        <button onclick="searchQnA()">Search</button>
                    </div>
                    <div id="searchResult" class="result"></div>
                </div>
                
                <div class="qa-card">
                    <h3>Get All Data</h3>
                    <p class="data-description">Retrieve all questions and answers from the knowledge base</p>
                    <button onclick="getAllData()">Get All Data</button>
                    <div id="dataResult" class="result"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact">
        <div class="container">
            <h2 class="section-title">Contact Us</h2>
            <form class="contact-form" id="contactForm">
                <div class="form-row">
                    <input type="text" placeholder="Your Name" required>
                    <input type="email" placeholder="Your Email" required>
                </div>
                <div class="form-row">
                    <input type="text" placeholder="Subject">
                </div>
                <div class="form-row">
                    <textarea placeholder="Your Message" required></textarea>
                </div>
                <button type="submit" class="submit-btn">Send Message</button>
            </form>
        </div>
    </section>

    <!-- Comments Section -->
    <section class="comments-section">
        <div class="container">
            <h2 class="section-title">Community Comments</h2>
            <div id="disqus_thread"></div>
            <div id="commentsFallback">
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">GameEnthusiast42</span>
                        <span class="comment-date">October 15, 2023</span>
                    </div>
                    <div class="comment-body">
                        Really looking forward to Ashes Till Tomorrow! The concept sounds amazing.
                    </div>
                </div>
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">HorrorGameFan</span>
                        <span class="comment-date">October 12, 2023</span>
                    </div>
                    <div class="comment-body">
                        Critter Land reminds me of classic mascot horror games but with a fresh twist. Can't wait to play it!
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div class="login-modal" id="login-modal" aria-hidden="true">
        <div class="login-form" role="dialog" aria-labelledby="login-title">
            <h2 id="login-title"><i class="fas fa-lock"></i> Authentication Required</h2>
            <div class="form-group">
                <label for="username">Username</label>
                <input id="username" type="text" placeholder="777">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input id="password" type="password" placeholder="777">
            </div>
            <button class="login-btn" id="submit-login">Access</button>
            <p id="login-message">Incorrect credentials. Please try again.</p>
        </div>
    </div>

    <!-- Control Panel Modal -->
    <div class="control-panel" id="control-panel" aria-hidden="true">
        <div class="control-panel-content" role="dialog" aria-labelledby="control-panel-title">
            <h2 id="control-panel-title"><i class="fas fa-cog"></i> Logo Control Panel</h2>
            <p class="panel-description">Select which logo to display on the website</p>
            
            <div class="logo-options">
                <div class="logo-option active" data-logo="regular">
                    <img src="images/logo.png" alt="Regular Logo" onerror="this.src='https://via.placeholder.com/160x80/6a11cb/ffffff?text=Regular+Logo'">
                    <p>Regular Logo</p>
                </div>
                <div class="logo-option" data-logo="pride">
                    <img src="images/logo-pride.png" alt="Pride Logo" onerror="this.src='https://via.placeholder.com/160x80/ff66aa/ffffff?text=Pride+Logo'">
                    <p>Pride Month Logo</p>
                </div>
            </div>
            
            <div class="panel-actions">
                <button class="login-btn" id="close-control-panel">Close Panel</button>
            </div>
        </div>
    </div>

    <!-- Audio Section -->
    <section id="audio">
        <div class="container">
            <div id="audio-content" class="audio-content">
                <div class="audio-header">
                    <h2 class="section-title">UNDERHEAT Studio Audio Collection</h2>
                    <div class="audio-actions">
                        <button class="btn" id="logout-btn">Log Out</button>
                    </div>
                </div>

                <div class="audio-collection">
                    <h3 class="collection-title">Deltarune Official Soundtrack <span class="composer">by Toby Fox</span></h3>
                    <div class="audio-gallery" id="audio-gallery">
                        <!-- Each audio-card contains a placeholder with data-video-id; clicking it will create the iframe -->
                        <div class="audio-card">
                            <div class="audio-container">
                                <div class="video-placeholder" data-video-id="iqoYq4x0RQw" style="background-image:url('https://img.youtube.com/vi/iqoYq4x0RQw/hqdefault.jpg');">
                                    <div class="video-play-btn"><i class="fas fa-play"></i></div>
                                </div>
                            </div>
                            <div class="audio-info">
                                <h4><span class="audio-name">Gyaa Ha ha!</span></h4>
                                <p class="audio-description">From Deltarune Chapter 2</p>
                            </div>
                        </div>

                        <div class="audio-card">
                            <div class="audio-container">
                                <div class="video-placeholder" data-video-id="tBdLO8u-0L8" style="background-image:url('https://img.youtube.com/vi/tBdLO8u-0L8/hqdefault.jpg');">
                                    <div class="video-play-btn"><i class="fas fa-play"></i></div>
                                </div>
                            </div>
                            <div class="audio-info">
                                <h4><span class="audio-name">Hammer of Justice</span></h4>
                                <p class="audio-description">From Deltarune Chapter 2</p>
                            </div>
                        </div>

                        <div class="audio-card">
                            <div class="audio-container">
                                <div class="video-placeholder" data-video-id="ApWpYmO7G28" style="background-image:url('https://img.youtube.com/vi/ApWpYmO7G28/hqdefault.jpg');">
                                    <div class="video-play-btn"><i class="fas fa-play"></i></div>
                                </div>
                            </div>
                            <div class="audio-info">
                                <h4><span class="audio-name">Spear of Justice</span></h4>
                                <p class="audio-description">From Undertale (Bonus Track)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="logo">UNDERHEAT Studio</div>
                <div class="social-links">
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-discord"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                </div>
                <p class="copyright">Â© 2023 UNDERHEAT Studio. All rights reserved.</p>
                <div class="admin-link">
                    <a href="#" id="admin-panel-link">Admin Panel</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Chatwoot Live Chat -->
    <script>
        (function(d,t) {
          var BASE_URL="https://app.chatwoot.com";
          var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
          g.src=BASE_URL+"/packs/js/sdk.js";
          g.defer = true;
          g.async = true;
          s.parentNode.insertBefore(g,s);
          g.onload=function(){
            window.chatwootSDK.run({
              websiteToken: 'your-chatwoot-token-here',
              baseUrl: BASE_URL
            })
          }
        })(document,"script");
    </script>

    <script src="https://cdn.jsdelivr.net/npm/simplelightbox@2.14.2/dist/simple-lightbox.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Simple credentials for demo:
            const CORRECT_USERNAME = "777";
            const CORRECT_PASSWORD = "777";

            const audioTab = document.getElementById('audio-tab');
            const loginModal = document.getElementById('login-modal');
            const submitLogin = document.getElementById('submit-login');
            const loginMessage = document.getElementById('login-message');
            const audioContent = document.getElementById('audio-content');
            const logoutBtn = document.getElementById('logout-btn');
            const adminPanelLink = document.getElementById('admin-panel-link');
            const controlPanel = document.getElementById('control-panel');
            const closeControlPanel = document.getElementById('close-control-panel');
            const logoOptions = document.querySelectorAll('.logo-option');
            
            // Hide login message initially
            loginMessage.style.display = 'none';
            
            // Current access state
            let accessType = null; // 'audio' or 'control-panel'

            // Initialize SimpleLightbox
            const lightbox = new SimpleLightbox('.gallery a', {
                captionsData: 'alt',
                captionDelay: 250
            });

            // Initialize image click handlers
            document.querySelectorAll('.project-img').forEach(img => {
                img.addEventListener('click', function() {
                    const src = this.getAttribute('data-src');
                    const caption = this.parentElement.querySelector('h3').textContent;
                    
                    // Create temporary gallery item for lightbox
                    const tempLink = document.createElement('a');
                    tempLink.href = src;
                    tempLink.setAttribute('data-title', caption);
                    
                    // Open lightbox
                    const tempGallery = new SimpleLightbox([tempLink], {
                        sourceAttr: 'href',
                        titles: caption
                    });
                    
                    tempGallery.open();
                    
                    // Clean up after lightbox is closed
                    tempGallery.on('closed.simplelightbox', function() {
                        tempGallery.destroy();
                    });
                });
            });

            // Initialize Cookie Consent
            window.cookieconsent.initialise({
                palette: {
                    popup: {
                        background: "#1a1a2e"
                    },
                    button: {
                        background: "linear-gradient(to right, #6a11cb, #2575fc)"
                    }
                },
                theme: "classic",
                position: "bottom-right",
                content: {
                    message: "We use cookies to enhance your experience and for analytics purposes.",
                    dismiss: "Got it!",
                    link: "Learn more",
                    href: "/privacy"
                }
            });

            // Contact form submission
            document.getElementById('contactForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Thank you for your message! We will get back to you soon.');
                this.reset();
            });

            // Share buttons functionality
            document.querySelectorAll('.share-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const platform = this.getAttribute('data-share');
                    let shareUrl = '';
                    
                    const pageUrl = encodeURIComponent(window.location.href);
                    const pageTitle = encodeURIComponent(document.title);
                    
                    switch(platform) {
                        case 'twitter':
                            shareUrl = `https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`;
                            break;
                        case 'facebook':
                            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
                            break;
                        case 'linkedin':
                            shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`;
                            break;
                        case 'reddit':
                            shareUrl = `https://reddit.com/submit?url=${pageUrl}&title=${pageTitle}`;
                            break;
                    }
                    
                    window.open(shareUrl, '_blank', 'width=600,height=400');
                });
            });

            // Handle logo error
            function handleLogoError() {
                const logoImg = document.getElementById('logo-img');
                logoImg.style.display = 'none';
                // Try to load the pride logo if regular one fails
                if (logoImg.src.includes('logo.png')) {
                    setTimeout(() => {
                        logoImg.src = 'images/logo-pride.png';
                        logoImg.style.display = 'block';
                    }, 100);
                }
            }

            // Logo selection functionality
            logoOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Update UI
                    logoOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update logo
                    const logoType = this.getAttribute('data-logo');
                    const logoImg = document.getElementById('logo-img');
                    
                    if (logoType === 'pride') {
                        logoImg.src = 'images/logo-pride.png';
                    } else {
                        logoImg.src = 'images/logo.png';
                    }
                    
                    // Store preference
                    localStorage.setItem('logoPreference', logoType);
                });
            });

            // Load saved logo preference
            const savedLogoPreference = localStorage.getItem('logoPreference');
            if (savedLogoPreference) {
                const logoImg = document.getElementById('logo-img');
                if (savedLogoPreference === 'pride') {
                    logoImg.src = 'images/logo-pride.png';
                    document.querySelector('.logo-option[data-logo="pride"]').classList.add('active');
                    document.querySelector('.logo-option[data-logo="regular"]').classList.remove('active');
                } else {
                    logoImg.src = 'images/logo.png';
                    document.querySelector('.logo-option[data-logo="regular"]').classList.add('active');
                    document.querySelector('.logo-option[data-logo="pride"]').classList.remove('active');
                }
            }

            // Open control panel when admin link clicked
            adminPanelLink.addEventListener('click', function(e) {
                e.preventDefault();
                accessType = 'control-panel';
                loginModal.style.display = 'flex';
                loginModal.setAttribute('aria-hidden', 'false');
            });

            // open modal when audio tab clicked
            audioTab.addEventListener('click', function (e) {
                e.preventDefault();
                accessType = 'audio';
                loginModal.style.display = 'flex';
                loginModal.setAttribute('aria-hidden', 'false');
            });

            // basic login behavior
            submitLogin.addEventListener('click', function () {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value.trim();

                if (username === CORRECT_USERNAME && password === CORRECT_PASSWORD) {
                    loginModal.style.display = 'none';
                    loginModal.setAttribute('aria-hidden', 'true');
                    loginMessage.style.display = 'none';
                    
                    if (accessType === 'audio') {
                        audioContent.style.display = 'flex';
                        audioContent.scrollIntoView({ behavior: 'smooth' });
                        // enable video placeholders after login
                        enablePlaceholders();
                    } else if (accessType === 'control-panel') {
                        controlPanel.style.display = 'flex';
                        controlPanel.setAttribute('aria-hidden', 'false');
                    }
                } else {
                    loginMessage.style.display = 'block';
                }
            });

            // logout hides audio section again
            logoutBtn.addEventListener('click', function () {
                audioContent.style.display = 'none';
                alert('You have been logged out from the audio section.');
            });

            // close control panel
            closeControlPanel.addEventListener('click', function() {
                controlPanel.style.display = 'none';
                controlPanel.setAttribute('aria-hidden', 'true');
            });

            // close modal when clicking outside the form
            window.addEventListener('click', function (ev) {
                if (ev.target === loginModal) {
                    loginModal.style.display = 'none';
                    loginModal.setAttribute('aria-hidden', 'true');
                }
                if (ev.target === controlPanel) {
                    controlPanel.style.display = 'none';
                    controlPanel.setAttribute('aria-hidden', 'true');
                }
            });

            // Function to convert a placeholder into an iframe on user click
            function createIframeForPlaceholder(placeholder) {
                const videoId = placeholder.dataset.videoId;
                if (!videoId) return;
                const iframe = document.createElement('iframe');
                // do not set autoplay; rely on user click to start playback
                iframe.src = `https://www.youtube.com/embed/${videoId}?rel=0`;
                iframe.setAttribute('allow', 'accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                iframe.setAttribute('allowfullscreen', '');
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '100%';
                iframe.style.height = '100%';
                iframe.loading = 'lazy';

                // Replace placeholder content with iframe
                const container = placeholder.parentElement; // .audio-container
                if (container) {
                    container.innerHTML = ''; // remove placeholder
                    container.appendChild(iframe);
                }
            }

            // Attach click events to placeholders (call this after login)
            function enablePlaceholders() {
                const placeholders = document.querySelectorAll('.video-placeholder');
                placeholders.forEach(ph => {
                    // avoid attaching multiple handlers
                    if (ph.dataset.enabled === 'true') return;
                    ph.dataset.enabled = 'true';
                    ph.addEventListener('click', function () {
                        createIframeForPlaceholder(ph);
                    });
                    // For accessibility allow Enter key to activate
                    ph.tabIndex = 0;
                    ph.addEventListener('keydown', function (e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            createIframeForPlaceholder(ph);
                        }
                    });
                });
            }

            // Q&A Functions
            const API_BASE = window.location.origin;
            
            async function addQnA() {
                const id = document.getElementById('id').value;
                const question = document.getElementById('question').value;
                const answer = document.getElementById('answer').value;
                
                if (!id || !question || !answer) {
                    document.getElementById('addResult').innerHTML = 'Please fill all fields';
                    return;
                }
                
                try {
                    const response = await fetch(`${API_BASE}/api/addanswer/${encodeURIComponent(id)}/${encodeURIComponent(question)}/${encodeURIComponent(answer)}`);
                    const result = await response.text();
                    document.getElementById('addResult').innerHTML = result;
                } catch (error) {
                    document.getElementById('addResult').innerHTML = 'Error: ' + error.message;
                }
            }
            
            async function searchQnA() {
                const id = document.getElementById('searchId').value;
                const question = document.getElementById('searchQuestion').value;
                
                if (!id || !question) {
                    document.getElementById('searchResult').innerHTML = 'Please fill all fields';
                    return;
                }
                
                try {
                    const response = await fetch(`${API_BASE}/api/search/${encodeURIComponent(id)}/${encodeURIComponent(question)}`);
                    const result = await response.text();
                    document.getElementById('searchResult').innerHTML = result;
                } catch (error) {
                    document.getElementById('searchResult').innerHTML = 'Error: ' + error.message;
                }
            }
            
            async function getAllData() {
                try {
                    const response = await fetch(`${API_BASE}/api/getdata`);
                    const result = await response.text();
                    document.getElementById('dataResult').innerHTML = '<pre>' + result + '</pre>';
                } catch (error) {
                    document.getElementById('dataResult').innerHTML = 'Error: ' + error.message;
                }
            }
        });
    </script>

    <!-- Plausible Analytics -->
    <script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.js"></script>

</body>
</html>
